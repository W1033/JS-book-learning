<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="widtd=device-widtd, user-scalable=no,
        initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Github fe-interview 仓库笔记运行草稿</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
            list-style: none;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <script type="text/javascript">        
        // JS判断手机端是否安装了某个客户端APP

        // 虽然在Js中可以启动某个app，但是并不能判断该app是否安装；
        // 但是，但是....还是有奇思淫巧滴，启动app需要的时间较长，js中断时间长，如果没安装，
        // js瞬间就执行完毕。直接上代码吧！
        // 一、

        function testApp(url) {
            var timeout, t = 1000, hasApp = true;
            setTimeout(function () {
                if (hasApp) {
                    alert('安装了app');
                } else {
                    alert('未安装app');
                }
                document.body.removeChild(ifr);
            }, 2000)

            var t1 = Date.now();
            var ifr = document.createElement("iframe");
            ifr.setAttribute('src', url);
            ifr.setAttribute('style', 'display:none');
            document.body.appendChild(ifr);
            timeout = setTimeout(function () {
                var t2 = Date.now();
                if (!t1 || t2 - t1 < t + 100) {
                    hasApp = false;
                }
            }, t);
        }

        // 二、

        function isInstalled(){
            var the_href=$(".down_app").attr("href");//获得下载链接
            window.location="apps custom url schemes";//打开某手机上的某个app应用
            setTimeout(function(){
                window.location=the_href;//如果超时就跳转到app下载页
            },500);
        }

 
        // apps custom url schemes是什么呢？
        // 其实就是你与app约定的一个协议URL，在IOS客户端或者Android客户端中可以设置
        // 一个URL Scheme。例如，设置URL Scheme：app，然后其他的程序就可以通过 
        // "URLString=app://" 调用该应用。还可以传参数，如：app://reaction/?uid=1
        // 以上介绍了怎么创建该本地协议及调用该本地协议的方法。但这里还有个关键就是怎么判断
        // 用户是否安装了该app呢？原理如下：
        // 在手机浏览器中用js代码请求该协议，如果在500ms内，如果有应用程序能解析这个协议，
        // 那么就能打开该应用；如果超过500ms就跳转到app下载页。

        // 作者：舞动乾坤
        // 链接：https://juejin.im/post/59eb06e4f265da432f304206
        // 来源：掘金
        // 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
    </script>
</body>

</html>