<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>è®¿é—®å™¨å±žæ€§ + 0bject.defineProperty</title>
</head>
<body>
<div>
    <h1>æˆ‘åœ¨è¿™é‡Œ</h1>
</div>
<script type="text/javascript">



    // ç¤ºä¾‹äºŒ: ðŸ”º è®¿é—®å™¨å±žæ€§æ˜¯å¯¹è±¡ä¸­çš„ä¸€ç§ç‰¹æ®Šå±žæ€§ï¼Œå®ƒä¸èƒ½ç›´æŽ¥å†å¯¹è±¡ä¸­è®¾ç½®ï¼Œè€Œå¿…é¡»é€šè¿‡
    // Object.defineProperty()æ–¹æ³•å•ç‹¬å®šä¹‰ã€‚
    // è®¿é—®å™¨å±žæ€§çš„"å€¼"æ¯”è¾ƒç‰¹æ®Šï¼Œè¯»å–æˆ–è®¾ç½®è®¿é—®å™¨å±žæ€§çš„å€¼ï¼Œå®žé™…ä¸Šæ—¶è°ƒç”¨å…¶å†…éƒ¨ç‰¹æ€§: get å’Œ set å‡½æ•°ã€‚
    let obj = {
        // è®¿é—®å™¨å±žæ€§ä¼š"è¦†ç›–"åŒåçš„æ™®é€šå±žæ€§ï¼Œå› ä¸ºè®¿é—®å™¨å±žæ€§ä¼šè¢«ä¼˜å…ˆè®¿é—®ã€‚
        hello: "æˆ‘å°†è¢«è¦†ç›–ï¼"
    };
    Object.defineProperty(obj, "hello", {
        // get å’Œ set æ–¹æ³•å†…éƒ¨çš„ this éƒ½æŒ‡å‘ obj, è¿™æ„å‘³ç€ get å’Œ set å‡½æ•°å¯ä»¥æ“ä½œå¯¹è±¡å†…éƒ¨çš„å€¼ã€‚
        get: function() {
            console.log("get æ–¹æ³•è¢«è°ƒç”¨äº†");
        },
        set: function(val) {
            console.log("set æ–¹æ³•è¢«è°ƒç”¨äº†ï¼Œå‚æ•°æ˜¯: " + val)
        }
    });
    obj.hello;  // è¯»å–å±žæ€§ï¼Œå°±æ˜¯è°ƒç”¨ get å‡½æ•°å¹¶è¿”å›ž get å‡½æ•°çš„è¿”å›žå€¼
    obj.hello = "AAA";  // ä¸ºå±žæ€§èµ‹å€¼ï¼Œå°±æ˜¯è°ƒç”¨ set å‡½æ•°ï¼Œå¤åˆ¶å…¶å®žæ—¶ä¼ å‚ã€‚



    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    /** ç¬¬å…­ç« : ã€Šjavascript é«˜çº§ç¨‹åºè®¾è®¡ã€‹
     2.è®¿é—®å™¨å±žæ€§: è®¿é—®å™¨å±žæ€§ä¸åŒ…å«æ•°æ®å€¼ï¼›å®ƒä»¬åŒ…å«ä¸€å¯¹å„¿ getter å’Œ setter å‡½æ•°(ä¸è¿‡ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¸æ˜¯å¿…éœ€çš„)ã€‚
     åœ¨è¯»å–è®¿é—®å™¨å±žæ€§æ—¶ï¼Œä¼šè°ƒç”¨getterå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£è¿”å›žæœ‰æ•ˆåœ°å€¼ï¼›åœ¨å†™å…¥è®¿é—®å™¨å±žæ€§æ—¶ï¼Œä¼šè°ƒç”¨setterå‡½æ•°å¹¶ä¼ å…¥æ–°å€¼ï¼Œ
     è¿™ä¸ªå‡½æ•°è´Ÿè´£å†³å®šå¦‚ä½•å¤„ç†æ•°æ®ã€‚è®¿é—®å™¨å±žæ€§æœ‰å¦‚ä¸‹4ä¸ªç‰¹æ€§ã€‚
     (1.) [[ Configurable ]] : è¡¨ç¤ºèƒ½å¦é€šè¿‡ delete åˆ é™¤å±žæ€§ä»Žè€Œé‡æ–°å®šä¹‰å±žæ€§ï¼Œèƒ½å¦ä¿®æ”¹å±žæ€§çš„ç‰¹æ€§ï¼Œæˆ–è€…èƒ½å¦æŠŠå±žæ€§
     ä¿®æ”¹ä¸ºæ•°æ®å±žæ€§ã€‚å¯¹äºŽç›´æŽ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±žæ€§ï¼Œè¿™ä¸ªç‰¹æ€§çš„é»˜è®¤å€¼ä¸ºtrueã€‚
     (2.) [[ Enumerable ]] :  è¡¨ç¤ºèƒ½å¦é€šè¿‡ for-in å¾ªçŽ¯è¿”å›žå±žæ€§ã€‚å¯¹äºŽç›´æŽ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±žæ€§ï¼Œè¿™ä¸ªç‰¹æ€§çš„é»˜è®¤å€¼ä¸ºtrueã€‚
     (3.) [[ Get ]] :         åœ¨è¯»å–å±žæ€§æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚ é»˜è®¤å€¼ä¸º undefinedã€‚
     (4.) [[ Set ]] :         åœ¨å†™å…¥å±žæ€§æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚ é»˜è®¤å€¼ä¸º undefinedã€‚
     è®¿é—®å™¨å±žæ€§ä¸èƒ½ç›´æŽ¥å®šä¹‰ï¼Œå¿…é¡»ä½¿ç”¨ Object.defineProperty()æ¥å®šä¹‰ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­:
     **/
    var book = {
        _year: 2004,
        edition: 1
    };

    // åœ¨ book å¯¹è±¡ä¸Šå®šä¹‰è®¿é—®å™¨å±žæ€§ year
    Object.defineProperty(book, "year", {
        get: function () {
            return this._year;
        },
        set: function (newValue) {
            if (newValue > 2004) {
                this._year = newValue;
                this.edition += newValue - 2004;
            }
        }
    });

    book.year = 2005;
    console.log(book.edition);

    /** ä»¥ä¸Šä»£ç åˆ›å»ºäº†ä¸€ä¸ªbookå¯¹è±¡ï¼Œå¹¶ç»™å®ƒå®šä¹‰ä¸¤ä¸ªé»˜è®¤çš„å±žæ€§: _year å’Œ editionã€‚ _yearå‰é¢çš„ä¸‹åˆ’çº¿æ˜¯ä¸€ç§
     å¸¸ç”¨çš„è®°å·ï¼Œç”¨äºŽè¡¨ç¤ºåªèƒ½é€šè¿‡å¯¹è±¡æ–¹æ³•è®¿é—®çš„å±žæ€§ã€‚è€Œè®¿é—®å™¨å±žæ€§ year åˆ™åŒ…å«ä¸€ä¸ª getter å‡½æ•°å’Œä¸€ä¸ª setter
     å‡½æ•°ã€‚ getterå‡½æ•°è¿”å›ž _year çš„å€¼ï¼Œsetter å‡½æ•°é€šè¿‡è®¡ç®—æ¥ç¡®å®šæ­£ç¡®çš„ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠŠ year å±žæ€§ä¿®æ”¹ä¸º
     2005ä¼šå¯¼è‡´ _year å˜ä¸º 2005, è€Œeditionå˜ä¸º2ã€‚ è¿™æ˜¯ä½¿ç”¨è®¿é—®å™¨å±žæ€§çš„å¸¸è§æ–¹å¼ï¼Œå³è®¾ç½®ä¸€ä¸ªå±žæ€§çš„å€¼ä¼š
     å¯¼è‡´å…¶ä»–å±žæ€§å‘ç”Ÿå˜åŒ–çŽ‡ã€‚**/





    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    /**  6.1.2 å®šä¹‰å¤šä¸ªå±žæ€§
     ç”±äºŽä¸ºå¯¹è±¡å®šä¹‰å¤šä¸ªå±žæ€§çš„å¯èƒ½æ€§å¾ˆå¤§ï¼ŒECMAScript 5 åˆå®šä¹‰äº†ä¸€ä¸ª Object.defineProperties()æ–¹æ³•ã€‚åˆ©ç”¨è¿™ä¸ª
     æ–¹æ³•å¯ä»¥é€šè¿‡æè¿°ç¬¦ä¸€æ¬¡å®šä¹‰å¤šä¸ªå±žæ€§ã€‚è¿™ä¸ªæ–¹æ³•æŽ¥å—ä¸¤ä¸ªå¯¹è±¡å‚æ•°:
     (1.)ç¬¬ä¸€ä¸ªä¸ªå¯¹è±¡æ—¶è¦æ·»åŠ å’Œä¿®æ”¹å…¶å±žæ€§çš„å¯¹è±¡ï¼Œ
     (2.)ç¬¬äºŒä¸ªå¯¹è±¡çš„å±žæ€§ä¸Žç¬¬ä¸€ä¸ªå¯¹è±¡ä¸­è¯æ·»åŠ æˆ–ä¿®æ”¹çš„å±žæ€§ä¸€ä¸€å¯¹åº”ã€‚ ä¾‹å¦‚:
     **/
    var book2 = {};
    Object.defineProperties(book2, {
        _year: {
            value: 2004,
            writable: true
        },
        edition: {
            value: 1,
            writable: true
        },
        year: {
            get: function () {
                return this._year;

            },
            set: function (newValue) {
                if (newValue > 2004) {
                    this._year = newValue;
                    this.edition += newValue - 2004;
                }
            }
        }
    });
    book2.year = 2017;
    console.log(book2.edition);
</script>
</body>
</html>